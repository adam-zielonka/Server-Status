<!DOCTYPE html>
<html lang="pl">
<head>
<title>Status</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style>
  .progress {
    margin-bottom: auto;
  }
</style>
<script>
  var info = {};

  info.getMemory = () => {

      var module = 'memory';
      $.get('os/memory', function (data) {
          var $box = $('#'+module);
          info.insertDatas($box, module, data);

          var $progress = $('.progress-bar', $box);
          $progress
              .css('width', data.percent_used + '%')
              .html(data.percent_used + '%')
              .removeClass('progress-bar-success progress-bar-warning progress-bar-danger');

          if (data.percent_used <= 50)
              $progress.addClass('progress-bar-success');
          else if (data.percent_used <= 75)
              $progress.addClass('progress-bar-warning');
          else
              $progress.addClass('progress-bar-danger');

      }, 'json');

  }

  info.getAll = function () {
      info.getMemory();
  }

  info.insertDatas = function ($box, block, datas) {
      for (var item in datas) {
          $('#' + block + '-' + item, $box).html(datas[item]);
      }
  }

  info.getAll();
</script>
</head>
<body>

<nav class="navbar navbar-default">
<div class="container-fluid">
  <div class="navbar-header">
    <a class="navbar-brand" href="/">Status</a>
  </div>
  <ul class="nav navbar-nav navbar-right">
    <li><a href="#" onclick="info.getAll()"><span class="glyphicon glyphicon-refresh"></span></a></li>
  </ul>
</div>
</nav>

<div class="container">
<div class="panel panel-default">
  <div class="panel-heading">Memory <a href="#" onclick="info.getMemory()"><span class="glyphicon glyphicon-refresh"></span></a></div>
  <div class="panel-body" id="memory">
  <table class="table table-striped">
      <tbody>
        <tr>
          <td class="col-md-1">Used %</td>
          <td>
            <div class="progress">
              <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40"
              aria-valuemin="0" aria-valuemax="100" style="width:0%">
                0%
              </div>
            </div>
          </td>
        </tr>
        <tr>
          <td class="col-md-1">Used</td>
          <td id="memory-used"></td>
        </tr>
        <tr>
          <td class="col-md-1">Free</td>
          <td id="memory-free"></td>
        </tr>
        <tr>
          <td class="col-md-1">Total</td>
          <td id="memory-total"></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
</div>

</body>
</html>
